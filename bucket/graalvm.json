{
    "description": "High-performance, embeddable, polyglot Virtual Machine for JVM-langs (Java, Scala, Kotlin), JavaScript/NodeJS, Python, Ruby, R, and LLVM-langs (C, C++, Rust)",
    "version": "23.0.0-20.0.1+9.1.sha.d5b915d",
    "homepage": "https://www.graalvm.org/",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.oracle.com/downloads/licenses/graal-free-license.html"
    },
    "url": "https://download.oracle.com/graalvm/20/latest/graalvm-jdk-20_windows-x64_bin.zip",
    "hash": "d5b915df33d0f959d2d51e67eb1bfa94666443b6e66fa5c7be2b4933ece3cf61",
    "extract_dir": "graalvm-jdk-20.0.1+9.1",
    "env_add_path": "bin",
    "env_set": {
        "JAVA_HOME": "$dir",
        "GRAALVM_HOME": "$dir"
    },
    "checkver": {
        "script": [
            "$graalvm_downloads = Invoke-RestMethod -Uri 'https://www.oracle.com/a/tech/docs/graalvm-downloads.json'",
            "$graalvm_version = ($graalvm_downloads.PSObject.Properties.Value | Where-Object { $_.Title -eq 'Oracle GraalVM' } | Select-Object -first 1 -expand Releases | Get-Member)[-1].Name",
            "$downloadUrl = 'https://download.oracle.com/graalvm/20/latest/graalvm-jdk-20_windows-x64_bin.zip'",
            "$hash = (Invoke-WebRequest \"$downloadUrl.sha256\").Content",
            "$zip = \"$cachedir\\$app#$graalvm_version#https_download.oracle.com_graalvm_20_latest_graalvm-jdk-20_windows-x64_bin.zip\"",
            "if (!((Test-Path $zip) -and ((Get-FileHash $zip).Hash -eq $hash))) {",
            "$download = Invoke-WebRequest '$downloadUrl' -o $zip -UseBasicParsing",
            "} else {",
            "Write-Warning 'Found identical GraalVM ZIP already, using that instead of redownloading...'",
            "}",
            "[void][Reflection.Assembly]::LoadWithPartialName('System.IO.Compression.FileSystem')",
            "$files = [IO.Compression.ZipFile]::OpenRead($zip).Entries",
            "$folderInZip = (($files | Where FullName -match '/' | Select -First 1).Fullname -Split '/')[0]",
            "$java_version = $folderInZip | Select-String '[\\d.]+\\+[\\d.]+' -AllMatches | % Matches | % Value",
            "$version = $graalvm_version + '-' + $java_version + '.sha.' + ($hash -replace '(?<=.{7}).+')",
            "Write-Output $version $folderInZip"
        ],
        "regex": "(?<version>[^\\s]+)\\s(?<extract>.+)"
    },
    "autoupdate": {
        "url": "https://download.oracle.com/graalvm/20/latest/graalvm-jdk-20_windows-x64_bin.zip",
        "extract_dir": "$matchExtract",
        "hash": {
            "url": "$url.sha256"
        }
    }
}
